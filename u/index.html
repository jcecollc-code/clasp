<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Clasp Profile</title>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@700;800&family=Outfit:wght@300;400;500;600&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<style>
:root{--blue:#0A66C2;--blue-dark:#004182;--blue-deep:#001B3D;--blue-light:#EAF3FF;--teal:#00B4A6;--green:#10B981;--green-light:rgba(16,185,129,0.1);--red:#EF4444;--bg:#F5F7FA;--text:#1A2332;--muted:#637B96;--light:#94A3B8;--border:#E4EBF4;--shadow:0 4px 16px rgba(0,30,80,0.08);--shadow-lg:0 16px 48px rgba(0,30,80,0.14);--radius:12px;}
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:'Outfit',sans-serif;background:var(--bg);color:var(--text);font-size:14px;-webkit-font-smoothing:antialiased;min-height:100vh;}

/* NAV */
.nav{background:white;border-bottom:1px solid var(--border);padding:0 24px;height:52px;display:flex;align-items:center;justify-content:space-between;position:sticky;top:0;z-index:100;}
.nav-logo{font-family:'Syne',sans-serif;font-size:1.2rem;font-weight:800;color:var(--blue-dark);display:flex;align-items:center;gap:8px;cursor:pointer;text-decoration:none;}
.logo-mark{width:28px;height:28px;border-radius:7px;background:var(--blue);display:flex;align-items:center;justify-content:center;}
.logo-mark svg{width:14px;height:14px;}
.nav-actions{display:flex;gap:10px;align-items:center;}
.btn{border:none;border-radius:8px;padding:8px 18px;font-family:'Outfit',sans-serif;font-size:0.85rem;font-weight:600;cursor:pointer;transition:all 0.15s;}
.btn-primary{background:var(--blue);color:white;}
.btn-primary:hover{background:var(--blue-dark);}
.btn-ghost{background:transparent;color:var(--muted);border:1.5px solid var(--border);}
.btn-ghost:hover{border-color:var(--blue);color:var(--blue);}

/* LAYOUT */
.page{max-width:860px;margin:0 auto;padding:32px 20px;}

/* PROFILE CARD */
.profile-card{background:white;border-radius:16px;border:1px solid var(--border);overflow:hidden;margin-bottom:16px;box-shadow:var(--shadow);}
.profile-cover{height:120px;background:linear-gradient(135deg,var(--blue-deep),var(--blue),var(--teal));}
.profile-body{padding:0 28px 28px;}
.profile-av-wrap{margin-top:-36px;margin-bottom:12px;}
.profile-av{width:72px;height:72px;border-radius:50%;border:4px solid white;background:linear-gradient(135deg,var(--blue),var(--teal));display:flex;align-items:center;justify-content:center;color:white;font-weight:700;font-size:1.4rem;box-shadow:var(--shadow);}
.profile-name{font-family:'Syne',sans-serif;font-size:1.5rem;font-weight:800;color:var(--blue-deep);}
.profile-headline{font-size:0.95rem;color:var(--muted);margin-top:4px;}
.profile-meta{display:flex;gap:20px;margin-top:10px;flex-wrap:wrap;}
.meta-item{font-size:0.8rem;color:var(--light);display:flex;align-items:center;gap:5px;}
.profile-about{margin-top:16px;font-size:0.9rem;line-height:1.75;color:var(--text);}
.profile-actions{display:flex;gap:10px;margin-top:20px;flex-wrap:wrap;}

/* SECTIONS */
.section-card{background:white;border-radius:var(--radius);border:1px solid var(--border);padding:22px 24px;margin-bottom:16px;box-shadow:var(--shadow);}
.section-title{font-family:'Syne',sans-serif;font-size:0.9rem;font-weight:700;color:var(--blue-deep);margin-bottom:14px;display:flex;align-items:center;gap:8px;}
.section-title::after{content:'';flex:1;height:1px;background:var(--border);}

/* TAGS */
.tags-wrap{display:flex;flex-wrap:wrap;gap:8px;}
.skill-tag{background:var(--blue-light);color:var(--blue);font-size:0.78rem;font-weight:500;padding:5px 14px;border-radius:20px;}
.open-tag{background:var(--green-light);color:var(--green);font-size:0.78rem;font-weight:500;padding:5px 14px;border-radius:20px;display:flex;align-items:center;gap:4px;}
.open-tag::before{content:'‚óè';font-size:0.5rem;}

/* EXPERIENCE */
.exp-item{display:flex;gap:14px;padding:14px 0;border-bottom:1px solid var(--border);}
.exp-item:last-child{border-bottom:none;padding-bottom:0;}
.exp-dot{width:36px;height:36px;border-radius:8px;background:var(--blue-light);display:flex;align-items:center;justify-content:center;flex-shrink:0;color:var(--blue);font-weight:700;font-size:0.75rem;}
.exp-title{font-size:0.9rem;font-weight:600;color:var(--text);}
.exp-company{font-size:0.82rem;color:var(--muted);margin-top:2px;}
.exp-dates{font-size:0.72rem;color:var(--light);margin-top:3px;}
.exp-desc{font-size:0.8rem;color:var(--muted);margin-top:6px;line-height:1.6;}

/* NOT FOUND */
.not-found{text-align:center;padding:80px 20px;}
.not-found-icon{font-size:3rem;margin-bottom:16px;}
.not-found-title{font-family:'Syne',sans-serif;font-size:1.5rem;font-weight:700;color:var(--blue-deep);margin-bottom:8px;}
.not-found-sub{font-size:0.9rem;color:var(--muted);}

/* LOADING */
.loading{text-align:center;padding:80px 20px;color:var(--muted);}
.loading-dot{display:inline-block;width:8px;height:8px;border-radius:50%;background:var(--blue);animation:ldot 1.2s infinite;margin:0 3px;}
.loading-dot:nth-child(2){animation-delay:0.2s;}
.loading-dot:nth-child(3){animation-delay:0.4s;}
@keyframes ldot{0%,60%,100%{transform:translateY(0);opacity:0.4}30%{transform:translateY(-8px);opacity:1}}

/* FOOTER */
.footer{text-align:center;padding:32px;color:var(--light);font-size:0.8rem;}
.footer a{color:var(--blue);text-decoration:none;font-weight:500;}

/* TOAST */
.toast{position:fixed;bottom:24px;right:24px;z-index:999;background:var(--blue-deep);color:white;padding:12px 20px;border-radius:10px;font-size:0.85rem;font-weight:500;box-shadow:var(--shadow-lg);display:flex;align-items:center;gap:8px;transform:translateY(80px);opacity:0;transition:all 0.3s;pointer-events:none;}
.toast.show{transform:translateY(0);opacity:1;}
</style>
</head>
<body>

<nav class="nav">
  <a class="nav-logo" href="/">
    <div class="logo-mark"><svg viewBox="0 0 16 16" fill="none"><path d="M3 8h10M8 3l5 5-5 5" stroke="white" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/></svg></div>
    Clasp
  </a>
  <div class="nav-actions">
    <button class="btn btn-ghost" onclick="window.location.href='/app.html'">Sign In</button>
    <button class="btn btn-primary" onclick="window.location.href='/'">Join Clasp</button>
  </div>
</nav>

<div class="page" id="page">
  <div class="loading">
    <div class="loading-dot"></div><div class="loading-dot"></div><div class="loading-dot"></div>
  </div>
</div>

<div class="footer">
  <a href="/">Clasp</a> ¬∑ Professional networking for the agent era
</div>

<div class="toast" id="toast"><span style="color:var(--teal)">‚ú¶</span><span id="toast-msg"></span></div>

<script>
const{createClient}=supabase;
const sb=createClient('https://exfejbtwxqczcghwfjyw.supabase.co','sb_publishable_0wsYlW-72LC8AxHCdgavQQ_I7-lu1RC');

async function init(){
  // Get username from URL: /u/username
  const parts=window.location.pathname.split('/');
  const username=parts[parts.indexOf('u')+1];
  if(!username){showNotFound();return;}

  const{data}=await sb.from('profiles').select('*').eq('username',username).eq('is_public',true).single();
  if(!data){showNotFound();return;}

  // Update page title and meta
  document.title=data.name+' ¬∑ Clasp';

  renderProfile(data);
}

function renderProfile(p){
  const colors=['linear-gradient(135deg,#0A66C2,#00B4A6)','linear-gradient(135deg,#004182,#0073B1)','linear-gradient(135deg,#0073B1,#00B4A6)','linear-gradient(135deg,#1E3A5F,#0A66C2)'];
  const avColor=colors[p.name.length%colors.length];
  const initials=(p.name||'U').split(' ').map(w=>w[0]).join('').toUpperCase().slice(0,2);
  const headline=p.headline||(( p.title||'')+(p.company?' at '+p.company:''));

  let html='';

  // Main profile card
  html+='<div class="profile-card">'+
    '<div class="profile-cover"></div>'+
    '<div class="profile-body">'+
      '<div class="profile-av-wrap"><div class="profile-av" style="background:'+avColor+'">'+initials+'</div></div>'+
      '<div class="profile-name">'+p.name+'</div>'+
      (headline?'<div class="profile-headline">'+headline+'</div>':'')+
      '<div class="profile-meta">'+
        (p.location?'<span class="meta-item"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/></svg>'+p.location+'</span>':'')+
        (p.website?'<a class="meta-item" href="'+p.website+'" target="_blank" style="color:var(--blue);text-decoration:none;"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></svg>'+p.website.replace('https://','')+'</a>':'')+
      '</div>'+
      (p.about?'<div class="profile-about">'+p.about+'</div>':'')+
      '<div class="profile-actions">'+
        '<button class="btn btn-primary" onclick="draftOutreach(\''+p.name+'\',\''+headline+'\')">‚ú¶ Draft outreach with Claude</button>'+
        '<button class="btn btn-ghost" onclick="copyLink()">Copy profile link</button>'+
        (p.website?'<a href="'+p.website+'" target="_blank" class="btn btn-ghost" style="text-decoration:none;">Website ‚Üó</a>':'')+
      '</div>'+
    '</div>'+
  '</div>';

  // Open To
  if(p.open_to&&p.open_to.length){
    html+='<div class="section-card">'+
      '<div class="section-title">Open To</div>'+
      '<div class="tags-wrap">'+p.open_to.map(s=>'<span class="open-tag">'+s+'</span>').join('')+'</div>'+
    '</div>';
  }

  // Skills
  if(p.skills&&p.skills.length){
    html+='<div class="section-card">'+
      '<div class="section-title">Skills</div>'+
      '<div class="tags-wrap">'+p.skills.map(s=>'<span class="skill-tag">'+s+'</span>').join('')+'</div>'+
    '</div>';
  }

  // Experience
  if(p.experience&&p.experience.length){
    html+='<div class="section-card">'+
      '<div class="section-title">Experience</div>'+
      p.experience.map(e=>'<div class="exp-item">'+
        '<div class="exp-dot">'+e.company.slice(0,2).toUpperCase()+'</div>'+
        '<div>'+
          '<div class="exp-title">'+e.title+'</div>'+
          '<div class="exp-company">'+e.company+'</div>'+
          '<div class="exp-dates">'+e.start+' ‚Äî '+(e.end||'Present')+'</div>'+
          (e.desc?'<div class="exp-desc">'+e.desc+'</div>':'')+
        '</div>'+
      '</div>').join('')+
    '</div>';
  }

  // Join CTA
  html+='<div style="background:linear-gradient(135deg,var(--blue-deep),var(--blue));border-radius:16px;padding:32px;text-align:center;margin-bottom:16px;">'+
    '<div style="font-family:Syne,sans-serif;font-size:1.2rem;font-weight:800;color:white;margin-bottom:8px;">Join '+p.name.split(' ')[0]+' on Clasp</div>'+
    '<div style="font-size:0.88rem;color:rgba(255,255,255,0.7);margin-bottom:20px;">The professional network where AI does the work</div>'+
    '<button class="btn btn-primary" onclick="window.location.href=\'/\'" style="background:white;color:var(--blue);">Get Early Access</button>'+
  '</div>';

  document.getElementById('page').innerHTML=html;
}

function showNotFound(){
  document.getElementById('page').innerHTML='<div class="not-found">'+
    '<div class="not-found-icon">üë§</div>'+
    '<div class="not-found-title">Profile not found</div>'+
    '<div class="not-found-sub">This profile doesn\'t exist or hasn\'t been made public yet.</div>'+
    '<div style="margin-top:24px;"><button class="btn btn-primary" onclick="window.location.href=\'/'+'\'">Join Clasp</button></div>'+
  '</div>';
}

function draftOutreach(name, role){
  window.location.href='/app.html?draft='+encodeURIComponent(name)+'&role='+encodeURIComponent(role);
}

function copyLink(){
  navigator.clipboard.writeText(window.location.href).then(()=>showToast('Profile link copied!'));
}

function showToast(msg){
  const t=document.getElementById('toast');
  document.getElementById('toast-msg').textContent=msg;
  t.classList.add('show');setTimeout(()=>t.classList.remove('show'),3000);
}

init();
</script>
</body>
</html>
